# Diverga QA Test Scenario: MIXED-001
# Mixed Methods Research Pipeline Test
# Tests C3 agent and integration strategy workflow

scenario:
  id: MIXED-001
  name: "Sequential Explanatory Design"
  description: |
    Tests mixed methods research workflow including:
    - Paradigm detection (mixed methods)
    - CP_RESEARCH_DIRECTION checkpoint
    - C3-MixedMethodsDesignConsultant agent
    - CP_INTEGRATION_STRATEGY checkpoint
    - E3-MixedMethodsIntegration agent
  paradigm: mixed_methods
  priority: high

agents_expected:
  primary: C3-MixedMethodsDesignConsultant
  secondary:
    - A1-ResearchQuestionRefiner
    - C1-QuantitativeDesignConsultant
    - C2-QualitativeDesignConsultant
    - E3-MixedMethodsIntegration

checkpoints_required:
  - id: CP_RESEARCH_DIRECTION
    level: REQUIRED
    validation:
      must_halt: true
      must_present_alternatives: true
      min_alternatives: 3
      must_show_t_scores: true
      must_wait_approval: true

  - id: CP_PARADIGM_SELECTION
    level: REQUIRED
    validation:
      must_halt: true
      must_present_alternatives: true
      min_alternatives: 3
      must_wait_approval: true

checkpoints_recommended:
  - id: CP_INTEGRATION_STRATEGY
    level: RECOMMENDED
    validation:
      must_halt: true
      must_present_alternatives: true
      min_alternatives: 3
      must_wait_approval: true

conversation_flow:
  - turn: 1
    user_input: |
      I need both quantitative survey data and qualitative interviews to understand
      AI adoption patterns among teachers. I want to first survey a large sample,
      then follow up with in-depth interviews to explain the patterns.

    expected_behaviors:
      paradigm_detection: mixed_methods
      keyword_matches:
        - "quantitative survey"
        - "qualitative interviews"
        - "AI adoption"
        - "explain the patterns"
      checkpoint_trigger: CP_RESEARCH_DIRECTION
      explicit_wait: true
      no_auto_proceed: true

    expected_response_elements:
      vs_alternatives:
        option_a:
          label: "Sequential Explanatory (QUAN → qual)"
          description: "Quantitative first, qualitative explains results"
          t_score_range: [0.50, 0.60]
          recommended: true
        option_b:
          label: "Sequential Exploratory (QUAL → quan)"
          description: "Qualitative first, quantitative validates findings"
          t_score_range: [0.40, 0.50]
          recommended: false
        option_c:
          label: "Convergent Parallel (QUAN + QUAL)"
          description: "Both strands simultaneously, merge results"
          t_score_range: [0.35, 0.45]
          recommended: false
        option_d:
          label: "Embedded Design"
          description: "One strand embedded within the other"
          t_score_range: [0.25, 0.35]
          recommended: false
      explicit_wait: true
      no_auto_proceed: true

  - turn: 2
    user_input: "[A] Sequential Explanatory"

    expected_behaviors:
      decision_logged: true
      agent_invoked: C3-MixedMethodsDesignConsultant
      model_tier: opus
      checkpoint_trigger: CP_INTEGRATION_STRATEGY
      explicit_wait: true
      no_auto_proceed: true

    expected_response_elements:
      vs_alternatives:
        option_a:
          label: "Building integration"
          description: "Qual strand built on quan results (sampling, instrument)"
          t_score_range: [0.50, 0.60]
          recommended: true
        option_b:
          label: "Merging integration"
          description: "Results merged in joint display"
          t_score_range: [0.40, 0.50]
          recommended: false
        option_c:
          label: "Connecting integration"
          description: "Analysis of one informs the other"
          t_score_range: [0.30, 0.40]
          recommended: false
      explicit_wait: true
      no_auto_proceed: true

  - turn: 3
    user_input: "[A] Building integration - use survey results to guide interview sampling"

    expected_behaviors:
      decision_logged: true
      agent_invoked: E3-MixedMethodsIntegration
      model_tier: opus
      checkpoint_trigger: null  # No checkpoint, proceed with design

    expected_response_elements:
      design_summary: true
      explicit_wait: false

validation_rules:
  required_checkpoints_count: 2
  required_agents:
    - C3-MixedMethodsDesignConsultant
    - E3-MixedMethodsIntegration
  checkpoint_sequence:
    - CP_RESEARCH_DIRECTION
    - CP_INTEGRATION_STRATEGY

t_score_expectations:
  overall_range:
    min: 0.25
    max: 0.60
  spread_requirement: 0.25

grading:
  checkpoint_weight: 0.40
  agent_accuracy_weight: 0.35
  vs_quality_weight: 0.25

tags:
  - mixed-methods
  - sequential-explanatory
  - integration
  - C3
  - E3

estimated_duration_minutes: 15
