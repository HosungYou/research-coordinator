# Diverga QA Protocol v3.2.2
# Scenario QUANT-005: Codex CLI Skill Loading Verification
#
# Purpose: Verify that Codex CLI properly loads SKILL.md files from .codex/skills/
# This tests the new skill system implementation for Codex CLI compatibility.
#
# Key Verification Points:
# 1. Skill activation message appears
# 2. VS methodology (T-Score options) is presented
# 3. Checkpoint markers (ðŸ”´/ðŸŸ /ðŸŸ¡) are used
# 4. Korean language support works
# 5. Behavioral checkpoint enforcement
#
# Complexity: MEDIUM (4-6 turns expected)
# Language: Korean
# CLI: Codex (primary), Claude Code (comparison)

scenario_id: QUANT-005
name: "Codex CLI Skill Loading Verification"
version: "3.2.2"
paradigm: quantitative
complexity_level: MEDIUM

# VERIFICATION HUDDLE
verification_huddle:
  enabled: true
  markers:
    - type: NO_SIMULATION_MARKERS
    - type: RESPONSE_LENGTH_VARIANCE
    - type: TIMESTAMP_VARIANCE
    - type: CONTEXT_AWARENESS
    - type: UNIQUE_SESSION_ID
    - type: DYNAMIC_CONTENT

# Skill Loading Verification (NEW in v3.2.2)
skill_loading:
  verify: true
  expected_skills:
    - research-coordinator
    - meta-analysis
    - checkpoint-system
  activation_markers:
    - "Research Coordinator"
    - "í™œì„±í™”"
    - "VS"
    - "T-Score"
    - "CHECKPOINT"

agents_involved:
  - C5-MetaAnalysisMaster
  - B3-EffectSizeExtractor

language: "Korean"
expected_turns: 4-6
expected_technical_questions: 1
expected_methodological_challenges: 1

checkpoints_expected:
  - id: CP_RESEARCH_DIRECTION
    level: RED
    mandatory_halt: true
    aliases:
      - "Research Direction"
      - "ì—°êµ¬ ë°©í–¥"

  - id: CP_EFFECT_SIZE_SELECTION
    level: RED
    mandatory_halt: true
    aliases:
      - "Effect Size Selection"
      - "íš¨ê³¼í¬ê¸° ì„ íƒ"

  - id: CP_ANALYSIS_MODEL
    level: ORANGE
    mandatory_halt: false
    aliases:
      - "Analysis Model"
      - "ë¶„ì„ ëª¨í˜•"

  - id: CP_METHODOLOGY_APPROVAL
    level: RED
    mandatory_halt: true
    aliases:
      - "Methodology Approval"
      - "ë°©ë²•ë¡  ìŠ¹ì¸"
      - "Analysis Plan"
      - "ë¶„ì„ ê³„íš"

conversation_flow:
  - turn: 1
    user_type: INITIAL_REQUEST
    user: |
      AI íŠœí„°ë§ ì‹œìŠ¤í…œì´ í•™ìƒ ì„±ì·¨ë„ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼ì— ëŒ€í•œ ë©”íƒ€ë¶„ì„ì„ ìˆ˜í–‰í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
      20ê°œì˜ ì—°êµ¬ì—ì„œ ë‹¤ì–‘í•œ íš¨ê³¼í¬ê¸°(Cohen's d, Hedges' g, ìƒê´€ê³„ìˆ˜ r)ê°€ ë³´ê³ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.
      ì–´ë–¤ íš¨ê³¼í¬ê¸° ì§€í‘œë¡œ í†µì¼í•´ì•¼ í• ê¹Œìš”?

    expected_behavior:
      # Skill loading verification
      skill_activation: true
      skill_markers:
        - "Research Coordinator"
        - "VS"
        - "T-Score"
        - "CHECKPOINT"

      # Standard behavior
      paradigm_detection: quantitative
      keyword_triggers:
        - "ë©”íƒ€ë¶„ì„"
        - "íš¨ê³¼í¬ê¸°"
      checkpoint: CP_RESEARCH_DIRECTION
      checkpoint_marker: "ðŸ”´"
      vs_options_min: 2
      t_score_shown: true
      language: Korean
      halt: true

  - turn: 2
    user_type: TECHNICAL_FOLLOW_UP
    user: |
      Hedges' gë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì¼ë¶€ ì—°êµ¬ëŠ” Fê°’ë§Œ ë³´ê³ í•˜ê³  ìžˆì–´ìš”.
      Fí†µê³„ëŸ‰ì—ì„œ Hedges' gë¡œ ì–´ë–»ê²Œ ë³€í™˜í•˜ë‚˜ìš”?

    expected_behavior:
      provides_formula: true
      discusses:
        - "F to g conversion"
        - "ë³€í™˜ ê³µì‹"
      checkpoint: CP_EFFECT_SIZE_SELECTION
      vs_options_min: 2
      language: Korean

  - turn: 3
    user_type: METHODOLOGICAL_CHALLENGE
    user: |
      íš¨ê³¼í¬ê¸°ë¥¼ ì¶”ì¶œí–ˆëŠ”ë° ì´ì§ˆì„±ì´ ë†’ê²Œ ë‚˜ì™”ì–´ìš” (IÂ² = 75%).
      ëžœë¤íš¨ê³¼ ëª¨í˜•ì„ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”? ì¡°ì ˆë³€ìˆ˜ ë¶„ì„ì€ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?

    expected_behavior:
      discusses:
        - "IÂ² í•´ì„"
        - "ëžœë¤íš¨ê³¼ ëª¨í˜•"
        - "ì¡°ì ˆë³€ìˆ˜"
      checkpoint: CP_ANALYSIS_MODEL
      checkpoint_marker: "ðŸŸ "
      vs_options_min: 2
      language: Korean

  - turn: 4
    user_type: APPROVAL
    user: |
      ê°ì‚¬í•©ë‹ˆë‹¤. Hedges' gë¥¼ ì‚¬ìš©í•˜ê³ , ëžœë¤íš¨ê³¼ ëª¨í˜•ìœ¼ë¡œ ë¶„ì„í•˜ë©°,
      í•™ìŠµ ìœ í˜•(ê°œë³„/í˜‘ë™)ê³¼ í”¼ë“œë°± ìœ í˜•(ì¦‰ê°/ì§€ì—°)ì„ ì¡°ì ˆë³€ìˆ˜ë¡œ ê²€í† í•˜ê² ìŠµë‹ˆë‹¤.
      ë¶„ì„ ê³„íšì„ ì •ë¦¬í•´ ì£¼ì„¸ìš”.

    expected_behavior:
      generates_summary: true
      checkpoint: CP_METHODOLOGY_APPROVAL
      checkpoint_marker: "ðŸ”´"
      language: Korean

validation_rules:
  # NEW: Skill loading validation
  skill_loading:
    activation_message_required: true
    vs_methodology_required: true
    checkpoint_markers_required: true
    min_skills_loaded: 1

  checkpoint_compliance:
    target: 50%
    red_checkpoints_must_halt: false  # Behavioral only in Codex

  language_consistency:
    input_language: Korean
    response_language: Korean
    must_match: true

  verification_huddle:
    no_dry_run_markers: true
    no_simulation_markers: true
    response_variance_required: true

metrics_targets:
  total_turns: ">=4"
  skill_loaded: true
  skill_confidence: ">=MEDIUM"
  checkpoint_markers_found: ">=2"
  vs_options_presented: ">=2"
  language_consistency: "100%"
  verification_huddle_pass: true

# Skill Loading Test Focus
# This scenario specifically tests:
# 1. SKILL.md files are discovered in .codex/skills/
# 2. Activation message appears at start
# 3. VS T-Score options are presented
# 4. Checkpoint markers (ðŸ”´/ðŸŸ ) are used
# 5. Korean language support maintained
# 6. Behavioral checkpoint enforcement (not tool-level)
